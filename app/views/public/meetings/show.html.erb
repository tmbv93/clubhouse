<div
  class="min-h-screen bg-center"
  style="<%= blur_background_styles(@meeting.logo, fallback_image: @meeting.platform.logo) %>"
>
  <div class="flex justify-between flex-col min-h-screen w-full p-4 backdrop-blur-3xl bg-white/60">
    <div class="max-w-lg mx-auto pt-8">
      <div class="text-center mb-8">
        <% if @meeting.logo.attached? %>
          <%= image_tag @meeting.logo, alt: "#{@meeting.title} logo", class: "rounded-full bg-white w-24 h-24 mx-auto mb-4 border-4 border-white" %>
        <% elsif @meeting.platform.logo.attached? %>
          <%= image_tag @meeting.platform.logo, alt: "#{@meeting.platform.name} logo", class: "rounded-full w-24 h-24 mx-auto mb-4 border-4 border-white" %>
        <% end %>
        <h1 class="text-xl font-bold mb-0"><%= @meeting.title %></h1>
        <p class="text-opacity-90 mt-0">
          <% if @meeting.scheduled? %>
            <%= datetime_format @meeting.happens_at, format: :pretty_datetime %>
          <% elsif @meeting.surveys.last&.meeting_date? %>
            <% meeting_date_survey = @meeting.surveys.last %>
            Either <%= meeting_date_survey.questions.first.alternatives.pluck(:title).to_sentence(last_word_connector: " or ") %>
          <% else %>
            No date set.
          <% end %>
          <br>
          <%= @meeting.location %>
        </p>

        <% if @meeting.description.present? %>
          <%= card class: "mt-8 px-4 md:px-8 py-4 text-left" do %>
            <div class="mb-4">
              <%= @meeting.description.presence %>
            </div>
            <strong><%= @meeting.platform.name %></strong>
          <% end %>
        <% end %>

        <div class="mx-auto max-w-3xl text-center">
          <% if @rsvp.anything_to_fill_out? %>
            <%= modal_link_to @rsvp.id ? edit_public_rsvp_path(@rsvp) : new_public_rsvp_path(invite_guid: @rsvp.invite&.guid, meeting_guid: @meeting.guid),
                              class: "text-center block p-4 bg-white bg-opacity-90 rounded-lg shadow-lg hover:bg-opacity-100 transition-all duration-200 transform hover:-translate-y-1" do %>
              <%= rsvps_action_text(@rsvp, @meeting) %>
            <% end %>
          <% else %>
            <%= button_to rsvps_action_link(@rsvp, @meeting),
                          method: :post,
                          data: { turbo_frame: "_top" },
                          params: {
                            invite_guid: @rsvp.invite.guid,
                            rsvp: {
                              answer: "yes"
                            }
                          },
                          class: "text-center w-full mb-2 block p-4 bg-white bg-opacity-90 rounded-lg shadow-lg hover:bg-opacity-100 transition-all duration-200 transform hover:-translate-y-1" do %>
              ✅ I'm in
            <% end %>

            <%= button_to rsvps_action_link(@rsvp, @meeting),
                          method: :post,
                          data: { turbo_frame: "_top" },
                          params: {
                            invite_guid: @rsvp.invite.guid,
                            rsvp: {
                              answer: "no"
                            }
                          },
                          class: "text-center w-full block p-4 bg-white bg-opacity-90 rounded-lg shadow-lg hover:bg-opacity-100 transition-all duration-200 transform hover:-translate-y-1" do %>
              ❌ Can't make it
            <% end %>
          <% end %>
        </div>
      </div>
    </div>

    <div class="flex h-40 items-center justify-center">
      <%= link_to root_path, target: "_blank" do %>
        Made with <strong>Twine</strong> 🧶
      <% end %>
    </div>
  </div>
</div>
